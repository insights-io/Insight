import { queryByText } from '@testing-library/testcafe';
import { Selector } from 'testcafe';

import {
  Sidebar,
  SignUpPage,
  OrganizationGeneralSettingsPage,
  LoginPage,
} from '../../../pages';

fixture('/settings/organization/general').page(
  OrganizationGeneralSettingsPage.path
);

test('[ORGANIZATION_GENERAL_SETTINGS]: User should be able to change general organization settings', async (t) => {
  const credentials = SignUpPage.generateRandomCredentials();
  await SignUpPage.signUpAndLogin(t, credentials);

  await t
    .click(Sidebar.banner.trigger)
    .click(Sidebar.banner.menu.organization.settings);

  /* Display Name */
  await t
    .expect(OrganizationGeneralSettingsPage.nameInput.value)
    .eql('Insight', 'Should have Insight value by default')
    .selectText(OrganizationGeneralSettingsPage.nameInput)
    .pressKey('delete')
    .typeText(OrganizationGeneralSettingsPage.nameInput, 'Rebrowse')
    .pressKey('tab') // blur input
    .expect(
      queryByText(
        'Successfully changed organization name from "Insight" to "Rebrowse"'
      ).visible
    )
    .ok('Should change organization name')
    .expect(OrganizationGeneralSettingsPage.nameInput.value)
    .eql('Rebrowse', 'Input value updated');

  /* Default Role */
  await t
    .click(OrganizationGeneralSettingsPage.defaultRoleSelect)
    .click(OrganizationGeneralSettingsPage.membershipSelect.admin)
    .pressKey('tab') // blur input
    .expect(
      queryByText(
        'Successfully changed organization default role from "member" to "admin"'
      ).visible
    )
    .ok('Should change default role');

  /* Open Membership */
  await t
    .click(OrganizationGeneralSettingsPage.openMembershipToggle)
    .expect(
      queryByText('Successfully enabled organization open membership').visible
    )
    .ok('Should change open membership');

  const smallLogoBase64 =
    'data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAYAAABV7bNHAAAEBklEQVR4nOycTSh8XRzHf2OGRkxmYmbhLbKhRLKxp3kWysLiSdnYILP1srKws7BWZKPslOIRWUhPSSyIvETMUF6SUebRoIw4zzn3P6b/nXuu47+Y8zvlfOo3zdyT7tenueeeOed2ssBMgNYArX9pxWiRH1Kx5P88kHTA5S9aYQXCYlc46cJEkFZcgXCqVDzpxMBP60KBUKoVc+J30pcQrb9Bk46XVpR10m3YSRSmzUFf/qNVgJ1EUR6ZIIKdQmXSx0GaNLQgAVqQAC1IgBYkQAsSoAUJ0IIEKCkoOzsbO0IKpQQFAgGYm5uDnZ0dCIVC2HFSYE8rGOVwOMjs7Cz55OPjg7S3t6PnUkZQMBg0pPzO8fEx8Xg82Nnw5bCilxbh0dHRgZpLiT7I6/VCU1MTt621tVVyGjNKCPL7/eDz+WzbMFFCUE5ODjidTm7b9fW15DRmlBAUj8fh9fWV27a4uCg5jRX0Dpp+g8je3p6lg56ZmSEulws7H74gVkNDQykxsViMjI6OErfbjZ7LBYowNTUFeXl5cHt7C6urqxAOh7EjGehJewFKdNIqowUJQO+DqquroaurC25ubmBychISiQR2JAtod4iamhpydXWVunuNjY2h37U4hXNiOnImKysrpnEPHTCSqqoqbCFqCGppaSHv7++WwWFfXx+2EFOhddI9PT2QlWU9PeuTVAJFUElJCdBvEMap/xgUQc3NzbbTG2wkrRIogr769kQiEYlJxEgXxJZ0GhsbuW1vb29wenoqOdHXSBdUXFwMZWVl3DZ2eZ2fn0tO9DXSBTE5+fn53LbDw0Nj8kwlpAsqLS0Fh8PBbdva2pKcRox0QXaT8HSMCBsbG7Z/5/F4jPki2UgXVFDAf6D2/v4eDg4OuG2VlZWwvr4Og4ODmYzGRbogt9vNPc76HyYpnfLycpifn4f6+nrjvWykC7Jb3tnd3bUcYx06k1NXV2d8vru7y2g2HtIF2S3vnJycmD5XVFTAwsICNDQ0pI5tbm5mNBsP6YIeHh64x4uKilLv2eW0vLxsksMErq2tZTxfOtJnFO1WSvv7+427FLsEu7u7TcIYIyMj8PT0JCOiBanzK7W1tSSRSHCf5LBjYmLi50yYscXAo6Ojb8thD1Xl5ub+HEGshoeHvyVnfHxchdVV+Sf1+Xxke3vbVszZ2Rnp7OzEFoMniBX9TUamp6fJ5eUliUajJBKJkKWlJdLb20sKCwuxpaQKfemZ/fRgzwe9vLzA8/MzZhQu6IJURy89C9CCBGhBArQgAVqQAC1IgBYkQAsSwAQ9YodQmEcmaB87hcLsM0H/YKdQGMON3mCJXxdJNwZ6iy5zmbbo+kRv8varuJu8faK3CUzbJvD/AAAA//90QVDAT2N5DgAAAABJRU5ErkJggg==';

  const largeLogoBase64 =
    'data:image/jpeg;base64,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1atXp24DKIkAAC108cUXp26hacuWLQsbNmxI3QZQEgEAWiTu+nfWWWelbqNpS5YsSd0CUCIBAFpk/PjxYeDAganbaNpzzz2XugWgRAIAtMhFF12UuoVuMQMAeREAoAXiFrpnnnlm6ja6xQwA5EUAgBY444wzKr+N7sKFC1O3AJRIAIAWOPvss1O30G2LFi1K3QJQIgEAWuC0005L3UK3mQGAvNgJELrpoIMOCk899VTqNrrljTfeCLvttlvtK5AHMwDQTaeeemrqFrpt8eLFBn/IjAAA3XTOOeekbqHbqj6DATROAIBu6oTn/4888kjqFoCSCQDQDUcccUTYb7/9UrfRbQ8//HDqFoCSCQDQDe9973tTt9AS8+fPT90CUDIBALphwoQJqVtoCTMAkB+vAUKTevfuHZYvX175HQBfeOGFsO+++6ZuAyiZGQBo0nHHHVf5wT/y6R/yJABAk0444YTULbTEvHnzUrcAJCAAQJOOPfbY1C20xMyZM1O3ACQgAECT4iOATvDggw+mbgFIwCJAaMKuu+4aVq1aFXbeeefUrXTLunXrQv/+/W0DDBkyAwBNOProoys/+Edz5swx+EOmBABoQqc8/zf9D/kSAKAJnv8DVScAQBM6ZQbAGwCQL4sAoUF9+/YNK1euDLvsskvqVrpl7dq1YcCAAWH9+vWpWwESMAMADTryyCMrP/hHM2bMMPhDxgQAaFCnTP9PnTo1dQtAQgIANEgAADqBAAANGjlyZOoWWkIAgLwJANCgESNGpG6h2/73f/83LFu2LHUbQEICADQg7v63//77p26j23z6BwQAaMABBxzQEVsACwCAAAAN6ITp/+i+++5L3QKQmAAADTj44INTt9Btq1evDrNnz07dBpCYAAAN6IQZgGnTpoUNGzakbgNITACABnTCDMCUKVNStwD0AAIANKATZgA8/wcihwFBA1544YUwePDg1G00LU79Dxw4MKxatSp1K0BiZgCgTv3796/04B/NnTvX4A/UCABQJ8//gU4iAECdhg0blrqFbhMAgE0EAKhT1af/IwEA2EQAgDpVPQAsXLgwLFq0KHUbQA8hAECd9t5779QtdMtdd92VugWgBxEAoE5VnwEQAIDNCQBQp6rPANx9992pWwB6EAEA6lTlGYD4/D8WwCYCANSpygHA9D+wJQEA6lTlRwACALAlZwFAnV5//fXQp0+f1G00JR5i5BEAsDkzAFCHAQMGVHbwj+/+d+Lg/973vjfccsstYfny5WH69Onh8ssvT90SVMrOqRuAKqjy9P8999yTuoWWiv9ZfOc73wkXX3zx29874YQTatWrV6/wgx/8IGF3UB1mAKAOVV4A2Emv/x166KFh2rRp7xj8N/eVr3wl7LyzzzVQDwEA6hCPAq6qTgkA7373u8PUqVNrIWBbDjzwwNqjAWDHBACoQ9++fVO30JTnnnsuLFiwIHUb3RYH/9///vd1zcRMnDixhI6g+gQAqMOuu+6auoWmdMKn/02D/8CBA+v+eWDHBACoQ1VnAKoeAI4++uiGBv/oqKOOsg4A6iAAQB2qGgCq/AbAEUccESZPntzQ4B/169cvHHDAAW3qCjqHAAB1qGIAeP7558MjjzySuo2mjBkzpvbJf9CgQU39fhX/84KyCQBQhyoOKFX99D9q1KjaJ//uvHpZ1TUbUCYBAOpQxQBQxef/I0eOrA3+73rXu7p1HQEAdkwAgDpUMQBUbQbgkEMOqQ3+Q4cO7fa1evfu3YKOoLMJAFCHqn2iXLFiRZgzZ07qNup20EEH1Qb/4cOHt+R68XwAYPsEAKhD1WYAZsyYkbqFusUV+3Hwb+XKfQEAdkwAgDpULQA89NBDqVuoS/zEHwf/eFxxK7300kstvR50IgEA6iAAtN6wYcNqg3989t9KK1euDOvXr2/pNaETCQBQhz59+qRuoSGzZs1K3cJ2xVX+cfCPq/5bzad/qI8AAHV4/fXXU7dQt1dffTU89thjqdvYpn322ae2yc9hhx3WlusLAFAfAQDqUKUAMHv27LBhw4bUbWzV3nvvXfvkP3r06LbdY+HChW27NnQSAQDqUKUAMHPmzNQtbNVee+1VG/zjHv/t9MADD7T1+tApBACow2uvvZa6hbr1xACwafCPJ/W12/Tp09t+D+gEAgDUwQxA8+K0/1133VXKOf3x0UcV3oCAnsCh2VCHqgSA+Prb/PnzU7fxtk0L/g4//PBS7hf/7vE1QGDHzABAHaryCODZZ58Nb775Zuo2aoYMGVI7kKiswT/q6a8/Qk8iAEAdqjIDsHjx4tQt1MRNfuK0fztX+2/NvffeW+r9oMoEAKhDVQLAM888k7qF2va+cfBv13v+2xIff/z2t78t9Z5QZQIA1GHdunWpW6hLfASQUjzQJw7+7djhb0fiWwZPP/106feFqhIAoA5V2V0uZQA4+OCDa4N/q/f2r9c111yT5L5QVQIA1OGFF15I3UJd1q5dm+S+caFffP7e6lP96vXiiy+G2267Lcm9oaoEAKhDVQJAfOe+bGPHjq0N/kOHDi393ptMmjQprFmzJtn9oYoEAKhDVQLAoEGDSr3fueeeG/7whz+EgQMHlnrfLf3Xf/1X0vtDFQkAUIfVq1cnm15vRHz3viyXXnppuOmmm0Lfvn1Lu+fWxL3/77///qQ9QBUJAFCnKswCxOn4Mnz5y18OP/rRj0q514787d/+beoWoJIEAKhTFQLAn/zJn9Tew2+nb37zm+Fb3/pWW+9RrylTpoRbb701dRtQSQIA1KkKASD62Mc+1pbrDhgwoPas/Stf+Upbrt+Mq6++OnULUFkCANTp+eefT91CXb70pS+F/v37t/Sa8R3/+Gn7L//yL1t63e648847a/sOAM0RAKBOCxcuTN1CXeI+/F/72tdadr0PfehDtTP2yzzUpx4+/UP3CABQpyeffDJ1C3W76qqrwre//e3Qp0+fpq+x77771nbXu/7668PgwYNb2F333XzzzWHatGmp24DK26iU2nGNGzduY9U8+OCDtb4b/bt+6lOf2rh06dLU7W/V8uXLNx500EHJ//ugVAdU8gaUqkQNHTo09djXtEmTJm2cMGHCxl69em3z77fXXnttvPLKKzfOnTs3dbvb9bnPfS75fxeU6oTq9da/AeoQt5vt169f6jaaFg8LuuWWW2p758e3GuLmRvHkvlinnnpq8h39duSOO+4IZ555Zuo2oCMIANCAOXPmhCOPPDJ1G1lavnx5OOaYYxz5Cy1iESA0oEoLATvNV7/6VYM/tJAAAA0QANKIjy1+8IMfpG4DOooAAA2YNWtW6hays2TJknDFFVekbgM6jgAADfDuebnWr18fLrzwwrB48eLUrUDHEQCgAQsWLKitoKcccbe/e+65J3Ub0JEEAGhQ3BaX9vvxj38c/umf/il1G9CxBABo0P3335+6hY43c+bMcPnll6duAzqaAAANmjp1auoWOtrSpUvDeeedF958883UrUBHsxEQNCgejLNs2bKw007yczuMHTs2zJgxI3Ub0PH8Lxg0KC4CnDdvXuo2OtL48eMN/lASAQCacMMNN6RuoeOcffbZYfLkyanbgGwIANCEeEY+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';

  await t
    .click(OrganizationGeneralSettingsPage.avatarRadio.uploadAvatar)
    .click(OrganizationGeneralSettingsPage.saveAvatarButton)
    .expect(queryByText('Required').visible)
    .ok('Should upload the avatar before saving')
    .setFilesToUpload(OrganizationGeneralSettingsPage.uploadAvatarInput, [
      '../../../../public/assets/icons/icon-72x72.png',
    ])
    .expect(Selector(`img[src="${smallLogoBase64}"]`).visible)
    .ok('Logo visible')
    .click(OrganizationGeneralSettingsPage.saveAvatarButton)
    .expect(
      queryByText('Please upload an image larger or equal than 258px by 258px')
        .visible
    )
    .ok('Avatar should be large enough')
    .setFilesToUpload(OrganizationGeneralSettingsPage.uploadAvatarInput, [
      '../../../../public/assets/icons/icon-512x512.png',
    ])
    .expect(Selector(`img[src="${largeLogoBase64}"]`).visible)
    .ok('Logo visible')
    .click(OrganizationGeneralSettingsPage.saveAvatarButton)
    .expect(queryByText('Successfuly saved avatar preferences').visible)
    .ok('Avatar preferences saved')
    .expect(Sidebar.avatarRoot.find('img').getAttribute('src'))
    .eql(largeLogoBase64, 'Should update the sidebar avatar');

  /* Delete organization */
  await t
    .click(OrganizationGeneralSettingsPage.deleteOrganizationButton)
    .click(OrganizationGeneralSettingsPage.deleteOrganizationConfirmButton)
    .expect(OrganizationGeneralSettingsPage.organizationDeletedToast.visible)
    .ok('Organization is deleted');

  /* Login */
  await LoginPage.loginActions(t, credentials)
    .expect(LoginPage.errorMessages.invalidCredentials.visible)
    .ok('Cannot login anymore');
});
